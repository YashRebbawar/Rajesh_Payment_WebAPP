{% extends "base.html" %}

{% block content %}
<div class="landing-container">
    <div id="status-message" class="status-message"></div>

    <!-- Top Right Auth / Profile -->
    <div class="auth-buttons">
        {% if user %}
        <div class="user-profile-wrapper">
            <button class="profile-icon-btn" id="profile-toggle">
                <div class="profile-icon">{{ user.email[0].upper() }}</div>
            </button>
            <div class="profile-dropdown" id="profile-dropdown">
                <div class="profile-card">
                    <div class="profile-avatar">{{ user.email[0].upper() }}</div>
                    <div class="profile-info">
                        <h3 class="profile-name">{{ user.email.split('@')[0] }}</h3>
                        <p class="profile-email">{{ user.email }}</p>
                        {% if user.country %}
                        <p class="profile-country">üìç {{ user.country }}</p>
                        {% endif %}
                        <p class="profile-date">Member since {{ user.created_at.strftime('%b %Y') if user.created_at else 'Recently' }}</p>
                    </div>
                    <div class="profile-actions">
                        <button class="btn-accounts" onclick="window.location.href='/accounts'">My Accounts</button>
                        <button class="btn-logout-card" onclick="window.location.href='/logout'">Logout</button>
                    </div>
                </div>
            </div>
        </div>
        {% else %}
        <button class="btn-signin" onclick="window.location.href='/signin'">Sign In</button>
        <button class="btn-register" onclick="window.location.href='/register'">Register</button>
        {% endif %}
    </div>

    <!-- Background Shapes -->
    <div class="hero-background">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
        </div>
    </div>

    <div class="hero-section">
        <!-- LEFT: Brand + Copy -->
        <div class="hero-content">
            <div class="brand-section">
                <div class="logo-container">
                    <img src="{{ url_for('static', filename='images/Printfree_logo.png') }}" alt="PrintFree Logo" class="logo-image">
                    <div>
                        <h1 class="brand-name">PrintFree</h1>
                        <p class="brand-subtitle">Multi-asset Trading Platform</p>
                    </div>
                </div>
                <p class="brand-tagline">Professional Trading Made Simple</p>
            </div>

            <div class="main-content">
                <div class="badge">üöÄ Trusted by 500K+ traders across 120+ countries</div>

                <h2 class="hero-title">
                    Trade <span class="highlight">Smarter</span>,<br>
                    Scale <span class="highlight">Faster</span>
                </h2>

                <p class="hero-subtitle">
                    Institutional-grade execution, ultra-tight spreads and tools built for scalpers, swing traders and long-term investors ‚Äì all in one modern platform.
                </p>

                <!-- Key platform benefits -->
                <div class="platform-pills">
                    <span class="pill">‚ö° 30ms Avg Execution</span>
                    <span class="pill">üìâ Spreads from 0.0 pips</span>
                    <span class="pill">üõ°Ô∏è Negative Balance Protection</span>
                </div>

                <div class="features-list">
                    <div class="feature-item">‚úì 250+ FX, Indices, Metals & Crypto pairs</div>
                    <div class="feature-item">‚úì Real-time tick data & depth of market</div>
                    <div class="feature-item">‚úì Risk & trade management dashboard</div>
                </div>

                <div class="hero-buttons">
                    <button class="btn-primary" onclick="window.location.href='/accounts'">
                        <span>Open Live Account</span>
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none">
                            <path d="M5 12h14m-7-7l7 7-7 7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                    </button>

                    <!-- CHANGED: View Stats -> Watch Demo -->
                    <button class="btn-secondary" id="watch-demo-btn">
                        <span class="demo-icon">‚ñ∂</span>
                        <span>Watch Platform Demo</span>
                    </button>
                </div>

                <!-- Trust strip -->
                <div class="trust-strip">
                    <div class="trust-item">
                        <span class="trust-label">Execution Quality</span>
                        <span class="trust-value">99.82% Fill Rate</span>
                    </div>
                    <div class="trust-divider"></div>
                    <div class="trust-item">
                        <span class="trust-label">Average Spread</span>
                        <span class="trust-value">0.2 pips on EURUSD</span>
                    </div>
                    <div class="trust-divider"></div>
                    <div class="trust-item">
                        <span class="trust-label">Support</span>
                        <span class="trust-value">24/7 Priority Chat</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- RIGHT: Trading UI Preview -->
        <div class="hero-visual">
            <div class="trading-dashboard">
                <div class="dashboard-header">
                    <div class="status-indicator"></div>
                    <span class="status-text">Live Environment ‚Ä¢ Real-Time Quotes</span>
                </div>

                <!-- Account Types / Tabs (visual only) -->
                <div class="dashboard-tabs">
                    <button class="dashboard-tab active">Standard</button>
                    <button class="dashboard-tab">Pro</button>
                    <button class="dashboard-tab">Raw Spread</button>
                </div>

                <!-- Market strip -->
                <div class="market-strip">
                    <div class="market-item">
                        <span class="symbol">EURUSD</span>
                        <span class="bid">1.0847</span>
                        <span class="ask">1.0849</span>
                        <span class="market-change positive">+0.21%</span>
                    </div>
                    <div class="market-item">
                        <span class="symbol">XAUUSD</span>
                        <span class="bid">2384.15</span>
                        <span class="ask">2384.90</span>
                        <span class="market-change positive">+0.58%</span>
                    </div>
                    <div class="market-item">
                        <span class="symbol">BTCUSD</span>
                        <span class="bid">67120</span>
                        <span class="ask">67145</span>
                        <span class="market-change negative">-0.32%</span>
                    </div>
                </div>

                <!-- Chart + price -->
                <div class="chart-container">
                    <div class="price-display">
                        <div>
                            <span class="currency">EUR/USD</span>
                            <span class="price">1.0847</span>
                        </div>
                        <div class="price-side">
                            <span class="change positive">+0.0023 (+0.21%)</span>
                            <span class="session-label">London | NY Overlap</span>
                        </div>
                    </div>
                    <div class="chart">
                        <svg viewBox="0 0 300 120" class="price-chart">
                            <defs>
                                <linearGradient id="chartFill" x1="0" y1="0" x2="0" y2="1">
                                    <stop offset="0%" stop-color="rgba(255, 237, 78, 0.5)"/>
                                    <stop offset="100%" stop-color="rgba(255, 237, 78, 0)"/>
                                </linearGradient>
                            </defs>
                            <path d="M10,90 Q40,70 70,80 T130,60 T190,40 T250,50 T290,30" stroke="#ffed4e" stroke-width="3" fill="none" stroke-linecap="round"/>
                            <path d="M10,90 Q40,70 70,80 T130,60 T190,40 T250,50 T290,30 L290,120 L10,120 Z" fill="url(#chartFill)"/>
                            <circle cx="290" cy="30" r="4" fill="#ffed4e"/>
                        </svg>
                    </div>
                </div>

                <!-- Open positions -->
                <div class="positions-list">
                    <div class="positions-header">
                        <span>Open Positions</span>
                        <span class="positions-pnl positive">+$324.15</span>
                    </div>
                    <div class="position-row">
                        <span class="pos-symbol">EURUSD</span>
                        <span class="pos-type buy">BUY 1.20</span>
                        <span class="pos-price">1.0832</span>
                        <span class="pos-slash">/</span>
                        <span class="pos-price">1.0847</span>
                        <span class="pos-pnl positive">+$180.00</span>
                    </div>
                    <div class="position-row">
                        <span class="pos-symbol">XAUUSD</span>
                        <span class="pos-type sell">SELL 0.50</span>
                        <span class="pos-price">2376.10</span>
                        <span class="pos-slash">/</span>
                        <span class="pos-price">2384.15</span>
                        <span class="pos-pnl negative">-$42.50</span>
                    </div>
                    <div class="position-row">
                        <span class="pos-symbol">US500</span>
                        <span class="pos-type buy">BUY 2.00</span>
                        <span class="pos-price">5320.4</span>
                        <span class="pos-slash">/</span>
                        <span class="pos-price">5332.9</span>
                        <span class="pos-pnl positive">+$186.65</span>
                    </div>
                </div>

                <!-- Platform badges -->
                <div class="platform-strip">
                    <span class="platform-label">Available on</span>
                    <div class="platform-badges">
                        <span class="platform-pill">üíª WebTrader</span>
                        <span class="platform-pill">üì± iOS & Android</span>
                        <span class="platform-pill">üñ•Ô∏è Desktop</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Demo Modal -->
    <div class="demo-modal" id="demo-modal">
        <div class="demo-backdrop" id="demo-backdrop"></div>
        <div class="demo-content">
            <button class="demo-close" id="demo-close">&times;</button>
            <div class="demo-video">
                <div class="demo-video-placeholder">
                    <div class="demo-play-icon">‚ñ∂</div>
                    <p>PrintFree Platform Walkthrough (2:15)</p>
                    <span>Embed your actual video or Loom link here.</span>
                </div>
            </div>
            <div class="demo-copy">
                <h3>See PrintFree in action</h3>
                <p>
                    Watch how traders manage positions, place orders in milliseconds and track risk across multiple assets ‚Äì all from one clean dashboard.
                </p>
                <button class="btn-primary btn-primary-compact" onclick="window.location.href='/register'">
                    Start in Under 60 Seconds
                </button>
            </div>
        </div>
    </div>
</div>

<script>
document.getElementById('profile-toggle')?.addEventListener('click', function() {
    const dropdown = document.getElementById('profile-dropdown');
    dropdown.classList.toggle('active');
});

document.addEventListener('click', function(e) {
    const wrapper = document.querySelector('.user-profile-wrapper');
    if (wrapper && !wrapper.contains(e.target)) {
        document.getElementById('profile-dropdown')?.classList.remove('active');
    }
});

function showStatus(message, type = 'success') {
    const statusEl = document.getElementById('status-message');
    statusEl.textContent = message;
    statusEl.className = `status-message ${type}`;
    statusEl.style.display = 'block';
    setTimeout(() => {
        statusEl.style.display = 'none';
    }, 4000);
}

const params = new URLSearchParams(window.location.search);
if (params.get('status') === 'registered') {
    showStatus('‚úì Registration successful! Welcome!', 'success');
    window.history.replaceState({}, document.title, window.location.pathname);
} else if (params.get('status') === 'loggedin') {
    showStatus('‚úì Logged in successfully!', 'success');
    window.history.replaceState({}, document.title, window.location.pathname);
} else if (params.get('status') === 'loggedout') {
    showStatus('‚úì You have been logged out successfully!', 'success');
    window.history.replaceState({}, document.title, window.location.pathname);
}

/* Demo modal logic */
const watchDemoBtn = document.getElementById('watch-demo-btn');
const demoModal = document.getElementById('demo-modal');
const demoBackdrop = document.getElementById('demo-backdrop');
const demoClose = document.getElementById('demo-close');

function openDemo() {
    demoModal?.classList.add('active');
    document.body.classList.add('no-scroll');
}
function closeDemo() {
    demoModal?.classList.remove('active');
    document.body.classList.remove('no-scroll');
}

watchDemoBtn?.addEventListener('click', openDemo);
demoBackdrop?.addEventListener('click', closeDemo);
demoClose?.addEventListener('click', closeDemo);

document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && demoModal?.classList.contains('active')) {
        closeDemo();
    }
});
</script>
{% endblock %}
